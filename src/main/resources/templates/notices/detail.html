<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      th:replace="~{layout :: layout(~{::body})}">
<head>
    <meta charset="UTF-8">
    <title th:text="${notice.title}">공지사항 상세</title>
    <style>
        .card-custom {
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            background-color: #fff;
        }

        .btn-rounded {
            border-radius: 999px;
            padding: 0.5rem 1.5rem;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .btn-green {
            background-color: #2e7d32;
            color: white;
            border: none;
        }

        .btn-green:hover {
            background-color: #1b5e20;
        }

        .btn-gray {
            background-color: #90a4ae;
            color: white;
            border: none;
        }

        .btn-gray:hover {
            background-color: #78909c;
        }

        .btn-outline-warning,
        .btn-outline-danger,
        .btn-outline-secondary {
            border-radius: 999px !important;
            font-weight: 500;
        }

        .attachment {
            background-color: #f1f8e9;
            padding: 0.75rem;
            border-radius: 12px;
            display: inline-block;
        }

        .attachment a {
            color: #2e7d32;
            font-weight: 500;
            text-decoration: none;
        }

        .attachment a:hover {
            text-decoration: underline;
        }

        body.dark-mode .card-custom {
            background-color: #1e1e1e;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <div class="card-custom">
        <h2 class="fw-bold mb-3" th:text="${notice.title}">공지 제목</h2>

        <div class="text-muted mb-3 small">
            <span th:text="'작성자: ' + ${notice.author.username}">작성자</span> ·
            <span th:text="${#dates.format(notice.createdAt, 'yyyy-MM-dd HH:mm')}">작성일</span>
        </div>

        <hr/>

        <div class="mb-4" style="white-space: pre-wrap;" th:text="${notice.content}">
            공지 내용
        </div>

        <!-- 첨부파일 다운로드 -->
        <div class="mb-4" th:if="${notice.storedFileName != null}">
            <div class="attachment">
                📎 <a th:href="@{|/uploads/notices/${notice.storedFileName}|}"
                     th:download="${notice.originalFileName}"
                     th:text="${notice.originalFileName}">첨부파일명</a>
            </div>
        </div>

        <!-- 관리자 전용 수정/삭제 버튼 -->
        <div class="mb-4 d-flex gap-2 flex-wrap"
             th:if="${#authorization.expression('hasAnyRole(''MID_ADMIN'',''TOP_ADMIN'')')}">
            <a th:href="@{|/notices/${notice.id}/edit|}" class="btn btn-outline-warning btn-rounded">✏️ 수정</a>

            <form th:action="@{|/notices/${notice.id}/delete|}" method="post" class="d-inline">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="btn btn-outline-danger btn-rounded"
                        onclick="return confirm('정말 삭제하시겠습니까?');">🗑 삭제</button>
            </form>
        </div>

        <!-- 목록으로 버튼 -->
        <a class="btn btn-gray btn-rounded" th:href="@{/notices}">← 목록으로</a>
    </div>
</div>
</body>
</html>